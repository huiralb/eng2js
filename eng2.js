(function(t,z,da){function C(a){for(var b={},d=0;d<l.length;d++)if(a===l[d].url){b=l[d].data;break}return b}function S(a){$(z).ready(a)}function T(a,b){var d=$("[controller='"+a+"']");if(!d.length)return!1;if("string"===typeof d&&!$(d)[0].childNodes.length)return console.log("Component failed"),!1;var c={};H[a]={callback:b,$root:c};var e=I(b),g=[],f=function(){g=[];$.each(e,function(a,b){switch(b){case "$root":g.push(c);break;case "$filter":g.push(q);break;default:u[b]&&g.push(u[b]),v[b]&&g.push(v[b]),
w[b]&&g.push(new w[b](c)),D[b]&&g.push(U(D[b],c))}});return g};f();var k=this,m=function(){f();b.apply(k,g);V(d,c);var a=J(d);$.extend(a,c);var e=E(d);x(e,c);F(d,c);K(d,c);L(d,c);M(d,c);c.watch=function(a,b){A[a]=b};y(d,c);c.$reload=function(){F(d,c);x(e,c);M(d,c)};c.$reset=function(a){var b=J(a);$.extend(c,b);b=E(a);$.each(b,function(a,b){e.push(b)});x(e,c);F(a,c);K(a,c);L(a,c);x(e,c)};c.$reload()};if(l.length){var n=function(a,b){if(a[b])switch(a[b].mode){case "getJSON":a[b].asLoad?n(a,b+1):(a[b].asLoad=
!0,$.getJSON(a[b].url,function(c){a[b].data=c;n(a,b+1)}));break;case "get":$.ajax({type:"GET",url:a[b].url,data:a[b].dataSend||{},success:function(c){l[b].data=c;n(a,b+1)}});break;case "post":$.ajax({type:"POST",url:a[b].url,data:a[b].dataSend||{},success:function(c){l[b].data=c;n(a,b+1)}})}else m()};n(l,0)}else m();return h}function y(a,b){var d=function(c){c=$(c);if(c.attr("each")){var e=W(c.attr("each"),b);c.clone();c.empty();var g=!0;if(e.advance.sort){var f=p(e.advance.sort,b),k=e.advance.sortBy;
if(k){if(k=p(e.advance.sortBy,b))e.data=q.sorting(e.data,{sort:f,key:k})}else f?e.data.sort():e.data.sort().reverse();b.watch(e.advance.sort,function(c){g&&(g=!1,y(a,b))});b.watch(e.advance.sortBy,function(c){g&&(g=!1,y(a,b))})}e.advance.filter&&(e.data=X(e.data,p(e.advance.filter,b),e.isHtml),b.watch(e.advance.filter,function(c){g&&(g=!1,y(a,b))}));var m=0;$.each(e.data,function(a,b){var d={};d[e.val]=b;d[e.key||"$index"]=a;d.$num=m;if(d.isHtml=e.isHtml)d[e.val]=$(b).clone()[0].outerHTML;var g=c.data("template-each"),
f=c;if(d.isHtml){var k=B(g),d=N(g,k,d);f.append(d)}else g=$(g),k=E(g),x(k,d),f.append(g),y(g,d);m++});e.advance.count&&(b[e.advance.count]=m);setTimeout(function(){b.$reset(c)})}else setTimeout(function(){$.each(c[0].childNodes,function(a,b){"#text"!==b.nodeName&&d(b)})})};d(a)}function W(a,b){a=a.split("|");var d=a[0].split(" in "),c=d[1].replace(/[ ]/g,""),d=d[0].replace(/[\(\)]/g,""),e=0;0<d.indexOf(",")&&(e=d.split(","),d=e[1],e=e[0]);var g={};a[1]&&$.each(a[1].split(","),function(a,b){var c=
b.split("="),e=c[0].replace(/[ ]/g,"");g[e]=c[1].indexOf(["'",'"'])?c[1].replace(/[ ]/g,""):c[1]});var f=b;1<c.split(".").length&&0>c.indexOf("$")?$.each(c.split("."),function(a,b){f=f[b]}):f=b[c]||eval(c);var k=!1;0<=c.indexOf("$")&&(k=!0);if(e)d=d.replace(/[ ]/g,"");else if(0<=d.indexOf(" ")){var e=d.split(" "),m=[];$.each(e,function(a,b){b&&m.push(b)});e=m[0];d=m[1]}return{data:f,val:d,key:e,advance:g,isHtml:k}}function X(a,b,d){var c=a instanceof Array?[]:{};$.each(a,function(e,g){0<=(d?$(g).text():
JSON.stringify(g)).indexOf(b)&&(a instanceof Array?c.push(g):c[e]=g)});return c}function V(a,b){var d=function(a){a=$(a);if(r[a[0].localName]){var e=O(a);return r[a[0].localName](b,a,e)}$.each(a[0].attributes,function(e,d){if(r[d.nodeName]){var k=O(a);return r[d.nodeName](b,a,k)}});"radio"===a[0].type&&a.attr("model")&&!a.attr("name")&&a.attr("name",a.attr("model"));$.each(a[0].childNodes,function(a,b){"#text"!==b.nodeName&&d(b)})};d(a)}function J(a){function b(a){a=$(a);if(a.attr("each"))return!1;
a.data("record")||(a.data("record",!0),$.each(a,function(g,f){if(P[f.type]){if(f.attributes.model){var k=f.attributes.model.nodeValue,m=Q(f);1<k.split(".").length?(k.split("."),eval("dataInits."+k+"= ''")):c[k]=m?m:""}}else f.attributes.model&&(k=f.attributes.model.nodeValue,c[k]="view"===a[0].localName?f.attributes.value?f.attributes.value.nodeValue:"":"");$.each(f.attributes,function(a,b){"init"===b.nodeName&&d.push(b.nodeValue)});$.each(f.childNodes,function(a,c){"#text"!==c.nodeName&&b(c)})}))}
var d=[],c={};b(a);$.each(d,function(a,b){b=b.split("; ").join(";").split(";");$.each(b,function(a,b){b=b.split("=");if(b[0])try{eval("dataInits."+b[0]+"="+b[1])}catch(d){c[b[0]]=[]}})});return c}function E(a){var b=[],d=function(a){a=$(a);a.attr("each")?a.data("template-each")||a.data("template-each",a.html()):$.each(a,function(a,c){var f=[],k=[];$.each(c.childNodes,function(a,b){"#text"===b.nodeName&&B(b.nodeValue).length&&f.push({component:b,oldValue:b.nodeValue})});$.each(c.attributes,function(a,
b){B(b.nodeValue).length&&k.push({component:b,oldValue:b.nodeValue})});if(k.length||f.length){var m={attributes:k,textNode:f};$(c).data("attributes",k);$(c).data("textNode",f);b.push(m)}$.each(c.childNodes,function(a,b){"#text"!==b.nodeName&&d(b)})})};d(a);return b}function x(a,b){$.each(a,function(a,c){$.each(c,function(a,c){$.each(c,function(a,c){var d=c.oldValue,e=c.component,g=B(d),d=N(d,g,b);e.nodeValue=d})})})}function L(a,b){var d=function(a){a=a.substr(0,a.indexOf("("));return a=a.split(".")[0]},
c=function(a){a=$(a);$.each(a[0].attributes,function(c,f){0<=Y.indexOf(f.nodeName)&&a[0].addEventListener(f.nodeName,function(c){if((t[d(f.nodeValue)]instanceof Function||t[d(f.nodeValue)]instanceof Object)&&"function"!==typeof b[d(f.nodeValue)])return console.log("window roots "+d(f.nodeValue)),!1;var g={};$.extend(g,b);c.root=b;g.$$event=c;g.$$this=a[0];c=p(f.nodeValue,g);delete g.$$event;delete g.$$this;c?$.extend(b,g):$.extend(g,b);b.$reload();Z(b,A)})});$.each(a[0].childNodes,function(a,b){"#text"!==
b.nodeName&&c(b)})};c(a)}function Z(a,b){var d=[];$.each(b,function(a,b){d.push(a)});$.each(a,function(c,e){if(0<=d.indexOf(c))b[c](a[c])})}function F(a,b){var d=function(a){a=$(a);var e=a[0].nodeName.toLowerCase();if("view"===e){var g=a.attr("model"),f=a.attr("value");f!==b[g]&&f&&r.view(b,a,{})}"#text"!=e&&$.each(a[0].attributes,function(d,e){if("model"===e.nodeName){var g=a[0],f=b[e.nodeValue];switch(g.nodeName.toLowerCase()){case "view":f&&$(g).attr("value",f);break;case "textarea":f&&$(g).val(f);
break;case "select":f&&$(g).val(f);break;case "input":switch(g.type){case "radio":$(g).attr("value")&&f&&($('input[name="'+g.attributes.name.nodeValue+'"][value="'+f+'"]')[0].checked=!0);break;case "checkbox":g.checked=f;break;case "range":$(g).val(f);break;default:$(g).val(f)}}}});$.each(a[0].childNodes,function(a,b){"#text"!==b.nodeName&&d(b)})};d(a)}function K(a,b){var d=function(a){a=$(a);"#text"!=a[0].nodeName.toLowerCase()&&$.each(a[0].attributes,function(b,d){"model"===d.nodeName&&c(a[0],d.nodeValue)});
$.each(a[0].childNodes,function(a,b){"#text"!==b.nodeName&&d(b)})},c=function(a,c){a.nodeName.toLowerCase();var d=P[a.type];d&&$.each(d,function(d,f){a.addEventListener(f,function(d){var f=Q(a);b[c]=f;if("function"===typeof A[c])A[c](f,a,d,c,b);b.$reload();return!1})})};d(a)}function M(a,b){$.each(R,function(a,c){c(a,b)})}function Q(a){switch(a.nodeName.toLowerCase()){case "textarea":return $(a).val();case "select":return $(a).val();case "input":switch(a.type){case "radio":return a.checked?a.value:
$('input[name="'+a.attributes.name.nodeValue+'"][checked]').val();case "number":return parseInt(a.value||0);case "checkbox":return a.checked;default:return $(a).val()}default:return $(a).val()}}function B(a){var b=[];a=a.split("^");1<a.length&&$.each(a,function(a,c){if(a)if("("==c.charAt(0)){var e=[];c.replace(/[(*)]/g,function(a,b,c){e.push({index:b,chars:a,mode:")"==a?"close":"open"})});for(var g=0,f=0,k=0,h=0;h<e.length;h++){f++;var n=e[h].mode;if(f&&("open"===n&&g++,"close"===n&&g--,k=e[h].index,
0===g))break}k++;g=c.substr(0,k);0<="-+/*?%".split("").indexOf(c.substr(k,1))?(k=c.split(" "),b.push(k[0].replace(/[\r\n]/g,""))):b.push(g.replace(/[\r\n]/g,""))}else k=c.split(" "),b.push(k[0].replace(/[\r\n]/g,""))});return b}function N(a,b,d){$.each(b,function(b,e){var g=p(e,d);a=a.replace("^"+e,g)});return a}function p(a,b){"("===a.charAt(0)&&(a=a.replace(/[\)\(]/g,""));if(b[a])return b[a];var d=aa(a);a=d[0];try{var c;(function(d){$.each(b,function(a,b){d[a]=b});c=eval(a);$.each(b,function(a,
c){b[a]=d[a];delete d[a]})})(t);return 1<d.length?ba(c,d.splice(1)):c}catch(e){return""}}function aa(a){if(0<=a.indexOf("|")){a=a.split("|");var b=[];$.each(a,function(a,c){if(a){var e=[],g=c.replace(/[\(\)]/g,"").split(" "),f=[];$.each(g,function(a,b){b&&f.push(b)});e.push(f[0]);g=f.splice(1).join("");b.push(e[0]+" "+g)}else b.push(c.replace(/[\(]/g,""))});return b}return[a]}function ba(a,b){b=b[0];var d={},c="";$.each(b.split(":"),function(a,b){if(a){var f=b.split("=");d[f[0]]=eval(f[1])}else c=
b.replace(/[ ]/g,"")});return q[c]?q[c](a,d):a}function G(a){a=z.createElement(a);return $(a)}function I(a){a=a.toString().replace(/[\r\n ]/g,"");a=a.substr(a.indexOf("(")+1,a.indexOf(")")-(a.indexOf("(")+1));return a.split(",")}function U(a,b){var d=I(a),c=[];$.each(d,function(a,d){switch(d){case "$root":c.push(b);break;case "$filter":c.push(q);break;default:u[d]&&c.push(u[d]),v[d]&&c.push(v[d]),w[d]&&c.push(new w[d](b))}});return a.apply(this,c)}function O(a){var b={};$.each($(a)[0].attributes,
function(a,c){b[c.nodeName]=c.nodeValue});return b}function ca(){$(z).ready(function(){$("body").find("[controller]").each(function(a,b){var d=b.attributes.controller.nodeValue||"controller_"+Math.floor(1E4*Math.random());H[d]||($(b).attr("controller",d),h.controller(d,function(){}))})})}var h=t.eng||(t.eng={}),P={text:["keyup"],email:["keyup"],url:["keyup"],radio:["change"],range:["mousemove","change"],number:["keyup","change"],checkbox:["click"],textarea:["keyup"],"select-one":["change"]},Y="abort autocomplete autocompleteerror beforecopy beforecut beforepaste blur cancel canplay canplaythrough change click close contextmenu copy cuechange cut dblclick drag dragend dragenter dragleave dragover dragstart drop durationchange emptied ended error focus input invalid keydown keypress keyup load loadeddata loadedmetadata loadstart mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup mousewheel paste pause play playing progress ratechange reset resize scroll search seeked seeking select selectstart show stalled submit suspend timeupdate toggle volumechange waiting webkitfullscreenchange webkitfullscreenerror wheel".split(" "),
A={},H={},w={},v={},D={},u={},q={},r={},R={},l=[];h.getJSON=function(a){a={mode:"getJSON",url:a,data:[],asLoad:!1};for(var b=!1,d=0;d<l.length;d++)if(l[d].url=a.url){b=!0;break}b||l.push(a);a=C(a.url);return a};h.get=function(a,b){l.push({mode:"get",url:a,data:[],dataSend:b,asLoad:!1});return C(a)};h.post=function(a,b){l.push({mode:"post",url:a,data:[],dataSend:b,asLoad:!1});return C(a)};h.controller=function(a,b){S(function(){T(a,b)});return h};h.config=function(a,b){u[a]=b;return h};h.module=function(a,
b){w[a]=b;return h};h.service=function(a,b){v[a]=b();return h};h.factory=function(a,b){D[a]=b;return h};h.filter=function(a,b){q[a]=b;return h};h.directive=function(a,b){r[a]=b;return h};h.tagDirective=function(a,b){R[a]=b;return h};h.template=function(a,b){return h};h.defaultEvent=function(a,b){return h};h.ell=G;h.filter("upper",function(a){return a.toUpperCase()});h.filter("lower",function(a){return a.toLowerCase()});h.filter("ucfirst",function(a){return a.substr(0,1).toUpperCase()+a.substr(1,a.length).toLowerCase()});
h.filter("sorting",function(a,b){var d=[],c=[],e={};$.each(a,function(a,d){e[d[b.key]+"_"+a]=d;c.push(d[b.key]+"_"+a)});b.sort?c.sort():c.sort().reverse();$.each(c,function(a,b){d.push(e[b])});return d});h.filter("comma",function(a,b){return a/parseInt(b.decimal)});h.filter("toInt",function(a,b){return parseInt(a)});h.filter("src",function(a,b){var d=new FileReader;d.readAsDataURL(a.target.files[0]);d.onload=function(){console.log(b,d.result);a.root[b.model]=d.result;a.root.$reload()}});h.filter("mid",
function(a,b){return a.substr(b.point1,b.point2)});h.filter("length",function(a,b){return a.length});h.directive("drop-file",function(a,b,d){var c=d["drop-file"];b=$(b)[0];b.addEventListener("dragover",function(a){a.stopPropagation();a.preventDefault()},!1);b.addEventListener("dragenter",function(a){a.stopPropagation();a.preventDefault()},!1);b.addEventListener("drop",function(b){b.stopPropagation();b.preventDefault();var d=[];$.each(b.dataTransfer.files,function(a,b){d.push(b)});var f=[],h=function(b){if(!b.length){var e=
[];$.each(f,function(a,b){e.push({src:b,file:d[a]})});a[c](e);return!1}var l=new FileReader;l.readAsDataURL(b[0]);l.onload=function(){f.push(l.result);h(b.splice(1))}};h(d)},!1)});h.directive("clone",function(a,b,d){a=parseInt(d.clone);b.removeAttr("clone");for(d=0;d<a-1;d++)$(b).clone().insertAfter($(b))});h.directive("checkbox",function(a,b,d){a="id_"+Math.floor(1E4*Math.random());var c=G("input").attr({type:"checkbox",model:d.model,id:a});G("label").attr("for",a).html(d.label).insertAfter($(b));
c.insertAfter($(b));$(b).remove()});h.directive("view",function(a,b,d){setTimeout(function(){var c=$(b).attr("value");c&&$(b).data("value")!==c&&($(b).data("value",c),$.ajax({url:c,cache:!1,success:function(c){$(b).empty().append(c).data("record",!1);a.$reset(b)}}))})});h.tagDirective("show",function(a,b){$("[show]").each(function(a,c){var e=$(c).attr("show");p(e,b)?$(c).show():$(c).hide()})});h.tagDirective("hide",function(a,b){$("[hide]").each(function(a,c){var e=$(c).attr("hide");p(e,b)?$(c).hide():
$(c).show()})});$(z).ready(function(){ca()})})(window,document);